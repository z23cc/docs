# Git 分支与合并

分支是 Git 最核心、最强大的功能之一。它允许你偏离主线开发流程，在一个独立的环境中进行工作，而不会影响到主线。

## 什么是分支？

想象一下你的项目开发过程是一条时间线。当你创建一个分支时，就好比从这条时间线上拉出一条新的平行线。你可以在这条新的线上进行修改、提交，而不会影响原来的那条线。完成开发后，你可以选择将这条新线上的改动合并回原来的主线。

Git 的分支非常轻量级，创建和切换分支几乎是瞬间完成的。

默认情况下，Git 仓库的主分支名为 `main`（旧版本可能是 `master`）。

## 创建分支

使用 `git branch` 命令可以创建一个新分支：

```bash
git branch <新分支名>
```
例如，创建一个名为 `feature-x` 的分支：
```bash
git branch feature-x
```
这只是创建了一个新的分支指针，你当前仍然停留在原来的分支上。

## 切换分支

使用 `git checkout` 命令或 `git switch` 命令（推荐，更清晰）可以切换到指定分支：

```bash
git checkout <分支名>
# 或者
git switch <分支名>
```
例如，切换到 `feature-x` 分支：
```bash
git switch feature-x
```
现在，你的工作目录中的文件会反映 `feature-x` 分支的状态，你所做的提交也会记录在这个分支上。

你也可以创建并立即切换到新分支：
```bash
git checkout -b <新分支名>
# 或者
git switch -c <新分支名>
```
例如：
```bash
git switch -c feature-y
```
这相当于 `git branch feature-y` 和 `git switch feature-y` 两条命令的组合。

## 查看分支

*   查看本地所有分支：
    ```bash
    git branch
    ```
    当前所在的分支会用 `*` 标记。

*   查看所有分支（包括远程跟踪分支）：
    ```bash
    git branch -a
    ```

## 合并分支

当你完成了某个分支（例如 `feature-x`）的开发，并希望将其改动合并回主分支（例如 `main`）时，需要执行以下步骤：

1.  切换回目标分支（接收改动的分支）：
    ```bash
    git switch main
    ```
2.  执行合并命令：
    ```bash
    git merge <要合并的分支名>
    ```
    例如：
    ```bash
    git merge feature-x
    ```
    Git 会尝试将 `feature-x` 分支上的改动合并到当前的 `main` 分支。

## 解决合并冲突

如果在两个分支上修改了同一个文件的同一部分，Git 可能无法自动合并，这时就会产生合并冲突（Merge Conflict）。你需要手动解决这些冲突。

1.  执行 `git merge` 后，Git 会提示哪些文件存在冲突。
2.  打开冲突的文件，你会看到类似以下的标记：
    ```
    <<<<<<< HEAD
    这里是当前分支 (main) 的内容
    =======
    这里是来自被合并分支 (feature-x) 的内容
    >>>>>>> feature-x
    ```
3.  你需要编辑文件，删除这些标记（`<<<<<<<`, `=======`, `>>>>>>>`），并决定最终要保留的内容。
4.  解决所有冲突后，使用 `git add` 将修改后的文件标记为已解决：
    ```bash
    git add <冲突文件名>
    ```
5.  最后，执行一次提交来完成合并：
    ```bash
    git commit -m "合并 feature-x 分支并解决冲突"
    ```
    （通常 Git 会自动生成一个合并提交信息，你可以直接使用或修改它）。

## 删除分支

当一个分支的工作完成并且已经合并到主线后，通常可以将其删除：

```bash
git branch -d <要删除的分支名>
```
例如：
```bash
git branch -d feature-x
```
如果分支有没有被合并的提交，Git 会阻止删除。如果你确定要强制删除（可能会丢失工作），可以使用 `-D` 选项：
```bash
git branch -D <要强制删除的分支名>
```

分支是进行并行开发、尝试新功能、修复 Bug 的利器。理解并熟练运用分支是高效使用 Git 的关键一步。